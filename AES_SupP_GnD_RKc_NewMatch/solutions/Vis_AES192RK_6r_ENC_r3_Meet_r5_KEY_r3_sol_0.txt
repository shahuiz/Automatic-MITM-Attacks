Model:
    Total: 6
    Start at: r3
    Meet at: r5
    KEY start at: r3

Initialization:
    ENC FWD: 6
    ENC BWD: 10
    KEY FWD: 14
    KEY BWD: 8

Solution:
    Obj := min{DF_b=3 - GnD_b=0, DF_r=3 - GnD_r=0, Match=3 - GnD_b - GnD_r - GnD_br=0} = 3

Visualization:
r0  bwd <---
SB#0        MC#0        fMC#0       fAK#0       fKEY#0      fSB#1       SB#1
rwww        rwww        gwww        gwww        gbwb        gwww        rwww
wrww        rwww        gwww        gwww        gbbb        gwww        rwww
wwrw        rwww        gwww        gwww        gbwb        gwww        rwww
wwwr        rwww        gwww        gwww        bbbb        bwww        bwww

                        bMC#0       bAK#0       bKEY#0      bSB#1   
                        rwww        rwww        rgwr        rwww
                        rwww        rwww        rrgr        rwww
                        rwww        rwww        ggwr        rwww
                        rwww        rwww        rrgg        gwww

AddKey costs fwdDf: 
[[0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]
 [1 0 0 0]]

r1  bwd <---
SB#1        MC#1        fMC#1       fAK#1       fKEY#1      fSB#2       SB#2
rwww        rwww        gbbb        bbbb        gbbb        bggb        brrb
rwww        wwwr        bbbg        bbbb        bggb        bbbg        bbbg
rwww        wwrw        bbgb        bbbb        bbbb        gbbb        rbbb
bwww        wbww        bbbb        bbbb        bbgb        ggbb        rrbb

                        bMC#1       bAK#1       bKEY#1      bSB#2   
                        rrrr        rrrg        rrgg        grrg
                        rrrr        rrrr        rrrr        gggg
                        rrrr        rggg        rggg        rggg
                        rgrr        rrrr        ggrr        rrgg

MixCol costs fwdDf: [1 0 1 1]    bwdDf: [0 1 0 0]

r2  bwd <---
SB#2        MC#2        fMC#2       fAK#2       fKEY#2      fSB#3       SB#3
brrb        brrb        bggb        bggb        bggb        gggb        rrrb
bbbg        bbgb        bbgb        bbgg        bbgg        bbgg        bbrr
rbbb        bbrb        bbgb        gbgb        gbgb        gggb        rrrb
rrbb        brrb        bggb        bbgb        bbgb        bggb        brrb

                        bMC#2       bAK#2       bKEY#2      bSB#3   
                        grrg        grrg        rrrg        rrrg
                        gggg        grrg        grgr        ggrr
                        ggrg        grrg        rrgg        rrrg
                        grrg        grrg        gggg        grrg

MixCol costs fwdDf: [0 2 0 0]    bwdDf: [0 2 1 0]
AddKey costs bwdDf: 
[[1 0 0 0]
 [0 0 0 1]
 [1 0 0 0]
 [0 0 0 0]]

r3  fwd --->        ENC_start
SB#3        MC#3        fMC#3       fAK#3       fKEY#3      fSB#4       SB#4
rrrb        rrrb        gggb        bbgb        bbgg        gbgb        rwrw
bbrr        brrb        bggb        bbgg        gbbg        bbbg        wbwr
rrrb        rbrr        gbgg        gbgb        gbgb        gbgb        gwrw
brrb        bbrr        bbgg        bggb        bgbb        bgbb        wrwb

                        bMC#3       bAK#3       bKEY#3      bSB#4   
                        rrrg        rrrr        ggrr        rrrr
                        grrg        rgrr        rggr        rgrr
                        rgrr        grrr        ggrg        grrr
                        ggrr        rrrg        rrgg        rrrg

MixCol costs fwdDf: [1 1 0 1]    bwdDf: [1 1 0 1]
AddKey costs fwdDf: 
[[1 0 0 0]
 [0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]]

r4  fwd --->
SB#4        MC#4        fMC#4       fAK#4       fKEY#4      fSB#5       SB#5
rwrw        rwrw        gwgw        gwgw        gbbb        gwbw        rwww
wbwr        bwrw        bwgw        bwgw        gggb        bwgw        bwrw
gwrw        rwgw        gwgw        bwgw        bbbb        bwbw        bwww
wrwb        bwrw        bwgw        bwgw        bbgg        bwgw        wwgw

                        bMC#4       bAK#4       bKEY#4      bSB#5   
                        rwrw        rwrw        gggg        rwrw
                        gwrw        rwrw        rrgg        gwrw
                        rwgw        gwrw        gggg        gwrw
                        gwrw        rwrw        ggrr        rwgw

MixCol costs fwdDf: [1 0 0 0]    bwdDf: [1 0 0 0]
AddKey costs bwdDf: 
[[0 0 0 0]
 [1 0 0 0]
 [0 0 0 0]
 [0 0 1 0]]

r5  mat -><-
SB#5        MC#5        fMC#5       fAK#5       fKEY#5      fSB#0       SB#0
rwww        rwww        gwww        ////        bbbb        wwww        rwww
bwrw        wrwb        wgwb        ////        bbbb        wgwb        wrww
bwww        wwbw        wwbw        ////        gbbb        wwbw        wwrw
wwgw        wwwg        wwwg        ////        bbbb        wwwb        wwwr

                        bMC#5       bAK#5       bKEY#5      bSB#0   
                        rwww        ////        rrrr        wwww
                        wrwg        ////        grrr        wrwr
                        wwgw        ////        rrrr        wwgw
                        wwwg        ////        gggg        wwwg


                                    fAT         fKEY#-1      fSB#0       SB#0
                                    bwww        wwbb
                                    wbwb        bbbb
                                    wwbw        wwgb
                                    wwwb        bbbb

                                    bAT         bKEY#-1      bSB#0   
                                    rwww        wwrr
                                    wrwr        grgr
                                    wwrw        wwrr
                                    wwwg        gggg

AddKey costs fwdDf: 
[[0 0 0 0]
 [0 1 0 0]
 [0 0 0 0]
 [0 0 0 0]]
AddKey costs bwdDf: 
[[0 0 0 0]
 [0 0 0 0]
 [0 0 1 0]
 [0 0 0 0]]

Identity Match:
Meet_FWD    SB#0
wwww        rwww
wrww        wrww
wwbw        wwrw
wwwb        wwwr

Key Schedule: starts at r3
KEY_SCHEDULE_0
wwbbgb
bbbbgb
wwgbgb
bbbbbb

wwrrrg
grgrrr
wwrrgg
ggggrr


KeyExp costs fwdDf: 
[[0 0 0 0 1 0]
 [0 0 0 0 0 0]
 [0 0 0 0 0 0]
 [0 0 0 0 0 0]]


KEY_SCHEDULE_1
wbgbbb    b    w    w
bbbggb    w    b    b
wbbbbb    b    w    w
bbbbgb    w    b    b

wrrrgg              w
grrrrr              g
wrrggg              w
ggggrr              g


KeyExp costs fwdDf: 
[[0 0 0 0 0 0]
 [0 0 0 0 0 0]
 [0 0 0 0 0 0]
 [0 0 0 0 1 0]]


KEY_SCHEDULE_2
bggbbb    b    b    b
bbgggb    b    b    b
gbgbgb    b    r    g
bbgbbg    r    b    b

rrrggg              g
grgrrg              g
rrgggg              r
ggggrr              g


KeyExp costs fwdDf: 
[[0 0 0 0 0 0]
 [0 0 0 0 0 0]
 [0 0 1 0 1 0]
 [0 0 1 0 0 0]]
KeyExp costs bwdDf: 
[[0 0 0 0 0 0]
 [0 0 1 0 0 0]
 [0 0 0 0 0 0]
 [0 0 0 0 0 0]]


KEY_SCHEDULE_3
gggbbb    b    b    b
bggggb    b    b    b
gbbbbb    b    r    g
bbbbgg    r    b    b

rrgggg              g
grrrgg              g
rggggg              r
ggggrr              g




KEY_SCHEDULE_4
bbbbbb
bbbbbb
gbbbbb
bbbbbb

rrrrrr
grrrrr
rrrrrr
ggggrr




